# -*- coding: utf-8 -*-
# spróbój czegos takiego jak
#read_coupon_fortuna_wo_sql=local_import('read_coupon_fortuna_wo_sql_27')
#from read_coupon_fortuna_wo_sql local_import read_coupon
import subprocess
import re
def index(): return dict(message="hello from read_coupon.py")


def hello():
    #rows=s.select()
    #rows=s.select()
    x=subprocess.call(['python3','/home/lesinle/odds/read_coupon_fortuna_wo_sql.py'])
    x=subprocess.check_output(['python3','/home/lesinle/odds/read_coupon_fortuna_wo_sql.py'])
    y1=re.sub('\[','',x)
    y2=re.sub(']','',y1)
    y=y2.split("'")
    #print (y
    #y = [x for x in y if x != ['[',']']]
    #y.remove('[')
    new_list=[]
    for el in y:
        if el not in [",","[","']","['","]","[","],","],[","], ["," ","\n",",","'"]:
            new_list.append(el)
    home2=[]
    home_list=[]
    away_list=[]
    typ_list=[]
    for i in range(1,len(new_list),6):
        home_list.append(new_list[i])
        away_list.append(new_list[i+2])
        typ_list.append(new_list[i+4])
    home2=new_list[1]+new_list[7]+new_list[13]+new_list[19]+new_list[25]
    db = DAL('sqlite://db.sqlite')
    db_name=db._uri
    bookies=['db_fortuna','db_sts','db_iforbet','db_lvbet','db_totolotek']
    for bookie in bookies:
        db.define_table(bookie, Field('home'),Field('away'),Field('game_1'),Field('game_0'),Field('game_2'),Field('game_10'),Field('game_02'),Field('game_12'),Field('data'),Field('Sport'),Field('League'),Field('country'),Field('dnb_1'),Field('dnb_2'),Field('o_05'),Field('o_15'),Field('o_25'),Field('o_35'),Field('o_45'),Field('o_55'),Field('o_65'),Field('o_75'),Field('o_85'),Field('o_95'),Field('u_05'),Field('u_15'),Field('u_25'),Field('u_35'),Field('u_45'),Field('u_55'),Field('u_65'),Field('u_75'),Field('u_85'),Field('u_95'),Field('ht_ft_11'),Field('ht_ft_1x'),Field('ht_ft_x1'),Field('ht_ft_22'),Field('ht_ft_x2'),Field('ht_ft_2x'),Field('ht_ft_xx'),Field('ht_ft_12'),Field('ht_ft_21'),Field('first_half_1'),Field('first_half_x'),Field('first_half_2'),Field('first_half_10'),Field('first_half_02'),Field('first_half_12'),Field('eh_min_1_1'),Field('eh_min_1_x2'),Field('u_25_1'),Field('o_25_1'),Field('u_25_x'),Field('o_25_x'),Field('u_25_2'),Field('o_25_2'),Field('first_goal_1'),Field('first_goal_2'),Field('first_goal_0'),Field('o_35_x'),Field('u_35_2'),Field('o_35_2'),Field('u_35_1'),Field('o_35_1'),Field('u_35_x'),Field('hour'),Field('update_time'),Field('btts_1'),Field('btts_2'),Field('btts_x'),Field('btts_no_x'),Field('btts_no_1'),Field('btts_no_2'),Field('u_15_1'),Field('u_15_x'),Field('u_15_2'),Field('o_15_x'),Field('o_15_1'),Field('o_15_2'),Field('eh_min_1_2'),Field('eh_min_1_x1'),Field('eh_plus_1_1'),Field('eh_plus_1_x2'),Field('eh_plus_1_2'),Field('eh_plus_1_x1'),Field('eh_plus_1_x'),Field('eh_min_1_x'),Field('btts_yes'),Field('btts_no'), migrate=False)
    sts=db.db_sts
    fortuna=db.db_fortuna
    home=sts.home
    away=sts.away
    wynik=[]
    for bookie in bookies:
            print(db((db[bookie].home=='Leicester') & (db[bookie].away=='Watford')).select())
            wynik.append(db((db[bookie].home=='Leicester') & (db[bookie].away=='Watford')).select())
            #wynik2=db((db.bookie.home=='Leicester') & (db.bookie.away=='Watford')).select()
            #wynik=[wynik1,wynik2]
        #else
        #    wynik = wynik&
#    wynik_temp=db(((db.db_sts.home=='Leicester') & (db.db_sts.away=='Watford')) | ((db.db_fortuna.home=='Leicester') & (db.db_fortuna.away=='Watford'))).select()
    #q = (home=='Leicester' & away=='Watford')
    #s=db(q)
    #for i in range(0,len(home_list)):
    #    rows=db((home==home_list[i]) & (away==away_list[i])).select()
    #    cos=typ_list[1]
    #rows = db((home=='Leicester') & (away=='Watford')).select()
    #select distinct db_sts.home, db_sts.away, db_sts.data, db_sts.game_1 as sts_1, db_fortuna.game_1 as fortuna_1 from db_sts JOIN db_fortuna on (db_sts.home=db_fortuna.home and db_sts.away=db_fortuna.away)
#where db_sts.home like 'Leicester' and db_sts.away like 'Watford'
#http://web2py.com/books/default/chapter/42/06/warstwa-abstracji-bazy-danych
    return locals()
